<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Campus Connect | Connect</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="min-h-screen bg-gray-50">

<header class="bg-white border-b sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4 h-16 flex items-center gap-4">
    <a href="dashboard.html" class="font-bold text-xl">Campus Connect</a>
    <span class="text-sm text-gray-500">| Connect</span>
  </div>
</header>

<main class="max-w-7xl mx-auto px-4 py-8">

  <h1 class="text-3xl font-bold mb-2">Connect with Seniors & Peers</h1>
  <p class="text-gray-500 mb-6">
    Find mentors based on exam preparation, branch, and experience
  </p>

  <!-- Filters -->
  <div class="bg-white rounded-xl shadow p-6 mb-8 space-y-4">
    <input id="searchInput" type="text" placeholder="Search by name..." class="w-full border rounded-lg px-4 py-2"/>
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
      <select id="programFilter" class="border rounded-lg px-3 py-2">
        <option value="">All Program</option>
        <option>BTech</option><option>MTech</option><option>BCA</option><option>MCA</option><option>MSc</option>
      </select>
      <select id="branchFilter" class="border rounded-lg px-3 py-2">
        <option value="">All Branches</option>
        <option>Computer Science</option><option>Information Technology</option>
        <option>Artificial Intelligence</option><option>Data Science</option>
      </select>
      <select id="yearFilter" class="border rounded-lg px-3 py-2">
        <option value="">All Years</option>
        <option>2nd Year</option><option>3rd Year</option><option>Final Year</option>
      </select>
      <select id="examFilter" class="border rounded-lg px-3 py-2">
        <option value="">All Exam Prep</option>
        <option>GATE</option><option>CAT</option>
      </select>
    </div>
  </div>

  <!-- Users Grid -->
  <div id="usersGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>

</main>

<script>
/* ---------- USERS ---------- */
const users = [
  { id: 1, name: "Aarav Mehta", branch: "Computer Science", year: "3rd Year", program: "BTech", exam: "GATE" },
  { id: 2, name: "Neha Singh", branch: "Data Science", year: "Final Year", program: "BCA", exam: "CAT" },
  { id: 3, name: "Rohit Verma", branch: "Artificial Intelligence", year: "Final Year", program: "MTech", exam: "GATE" },
  { id: 4, name: "Ananya Sharma", branch: "Information Technology", year: "2nd Year", program: "MCA", exam: "CAT" }
];

/* ---------- CONNECTIONS ---------- */
let connections = JSON.parse(localStorage.getItem("connectionsMade")) || [];

/* ---------- STATUS ---------- */
function getStatus(userId) {
  const c = connections.find(c => c.id === userId);
  return c ? "connected" : "none";
}

/* ---------- RENDER USERS ---------- */
const grid = document.getElementById("usersGrid");

function renderUsers(list) {
  grid.innerHTML = "";
  if (list.length === 0) {
    grid.innerHTML = `<div class="col-span-full text-center text-gray-500 py-10">No users match your filters</div>`;
    return;
  }

  list.forEach(user => {
    const status = getStatus(user.id);

    let buttonHTML = `<button onclick="viewProfile(${user.id})"
        class="w-full border border-gray-300 py-2 rounded-lg mb-2 hover:bg-gray-100">View Profile</button>`;

    if (status === "none") {
      buttonHTML += `<button onclick="connectUser(${user.id})"
        class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">Connect</button>`;
    }

    if (status === "connected") {
      buttonHTML += `<button onclick="openChat(${user.id})"
        class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700">Chat</button>`;
    }

    grid.innerHTML += `
      <div class="bg-white rounded-xl shadow p-5">
        <div class="flex items-center gap-3 mb-3">
          <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center font-bold text-blue-700">
            ${user.name[0]}
          </div>
          <div>
            <p class="font-semibold">${user.name}</p>
            <p class="text-xs text-gray-500">${user.branch}</p>
          </div>
        </div>

        <p class="text-xs text-gray-500 mb-4">
          ${user.program} • ${user.year} • ${user.exam}
        </p>

        ${buttonHTML}
      </div>`;
  });
}

/* ---------- FILTER LOGIC ---------- */
function applyFilters() {
  const search = document.getElementById("searchInput").value.toLowerCase();
  const program = document.getElementById("programFilter").value;
  const branch = document.getElementById("branchFilter").value;
  const year = document.getElementById("yearFilter").value;
  const exam = document.getElementById("examFilter").value;

  const filtered = users.filter(u =>
    u.name.toLowerCase().includes(search) &&
    (program === "" || u.program === program) &&
    (branch === "" || u.branch === branch) &&
    (year === "" || u.year === year) &&
    (exam === "" || u.exam === exam)
  );

  renderUsers(filtered);
}

/* ---------- EVENTS ---------- */
document.getElementById("searchInput").addEventListener("input", applyFilters);
document.getElementById("programFilter").addEventListener("change", applyFilters);
document.getElementById("branchFilter").addEventListener("change", applyFilters);
document.getElementById("yearFilter").addEventListener("change", applyFilters);
document.getElementById("examFilter").addEventListener("change", applyFilters);

/* ---------- CONNECT USER ---------- */
function connectUser(userId) {
  const user = users.find(u => u.id === userId);
  if (!connections.some(c => c.id === userId)) {
    connections.push({ id: user.id, name: user.name });
    localStorage.setItem("connectionsMade", JSON.stringify(connections));
  }
  applyFilters();
}

/* ---------- VIEW PROFILE ---------- */
function viewProfile(id) {
  localStorage.setItem("viewProfileUserId", id);
  window.location.href = "view-profile.html";
}

/* ---------- OPEN CHAT ---------- */
function openChat(id) {
  localStorage.setItem("activeChatId", id);
  window.location.href = "chat.html";
}

/* ---------- INIT ---------- */
applyFilters();
lucide.createIcons();
</script>

</body>
</html>

